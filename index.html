<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChronoNotes AI</title>
    <style>
        /* --- CSS æ ·å¼ --- */
        :root {
            /* å®šä¹‰é¢œè‰²å˜é‡ */
            --bg-color: #0f172a; /* æ·±è“èƒŒæ™¯ */
            --card-color: #1e293b; /* å¡ç‰‡èƒŒæ™¯ */
            --text-light: #e2e8f0; /* æµ…è‰²æ–‡å­— */
            --text-placeholder: #64748b; /* å ä½ç¬¦æ–‡å­— */
            --accent-blue: #4a90e2; /* è“è‰²å¼ºè°ƒ */
            --accent-green: #66bb6a; /* ç»¿è‰²æˆåŠŸ */
        }
        
        /* æ ¸å¿ƒä¿®å¤ï¼šè®¾ç½®æ‰€æœ‰è¾“å…¥æ§ä»¶ä¸º border-box æ¨¡å¼ï¼Œç¡®ä¿ padding å’Œ border ä¸ä¼šå¯¼è‡´æº¢å‡º */
        input, textarea, button {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif, 'Segoe UI';
            background-color: var(--bg-color);
            color: var(--text-light);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 450px;
            background-color: var(--bg-color);
            padding: 0;
        }

        /* å¤´éƒ¨å’Œç»Ÿè®¡ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
            color: var(--text-light);
            font-size: 1.1em;
        }
        .header h1 {
            font-size: 1.5em;
            margin: 0;
            display: flex;
            align-items: center;
        }
        .header .icon {
            font-size: 24px;
            margin-right: 10px;
            color: var(--accent-blue);
        }

        /* æ–°å»ºè®°äº‹å¡ç‰‡ */
        .new-memo-card {
            background-color: var(--card-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            margin-bottom: 30px;
        }
        .new-memo-card h2 {
            font-size: 1.1em;
            font-weight: 500;
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--accent-blue);
            display: flex;
            align-items: center;
        }

        /* è¾“å…¥åŒº */
        .input-group {
            margin-bottom: 15px;
        }

        .text-input-area {
            width: 100%; /* å®½åº¦å æ»¡çˆ¶å®¹å™¨ */
            min-height: 80px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #334155;
            background-color: #0f172a;
            color: var(--text-light);
            resize: none;
            font-size: 16px;
        }
        .text-input-area::placeholder {
            color: var(--text-placeholder);
        }

        /* æ—¥æœŸè¾“å…¥ */
        .date-input-group {
            display: flex;
            align-items: center;
            border-radius: 8px;
            border: 1px solid #334155;
            background-color: #0f172a;
            padding: 8px 10px;
        }
        .date-input-group input[type="date"] {
            flex-grow: 1;
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 16px;
            padding: 0;
        }
        /* éšè—é»˜è®¤æ—¥æœŸå›¾æ ‡ */
        .date-input-group input[type="date"]::-webkit-calendar-picker-indicator {
            opacity: 0; 
        }

        /* æ·»åŠ æŒ‰é’® */
        .add-button {
            width: 100%;
            padding: 12px;
            background-color: var(--accent-blue);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .add-button:hover {
            background-color: #3b82f6;
        }

        /* æ—¶é—´è½´æ ‡é¢˜ */
        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 0 5px;
            color: var(--text-placeholder);
        }
        .timeline-header button {
            background: none;
            border: 1px solid var(--text-placeholder);
            color: var(--text-placeholder);
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }

        /* åˆ—è¡¨å’Œäº‹é¡¹ */
        .memo-list {
            list-style: none;
            padding: 0;
        }

        .memo-item {
            background-color: #2d3748; /* äº‹é¡¹å¡ç‰‡èƒŒæ™¯ */
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: background-color 0.2s;
        }

        .memo-details {
            flex-grow: 1;
        }
        .memo-details .date {
            font-size: 0.8em;
            color: var(--accent-green);
            margin-bottom: 5px;
        }
        .memo-details .desc {
            font-size: 1em;
        }

        /* åŠ¨ä½œæŒ‰é’®ç»„ */
        .memo-actions {
            flex-shrink: 0;
            display: flex;
            gap: 10px;
        }
        .memo-actions button {
            background: none;
            border: none;
            color: var(--text-placeholder);
            cursor: pointer;
            font-size: 1.1em;
            transition: color 0.2s;
        }
        .memo-actions button:hover {
            color: var(--accent-blue);
        }

        /* æš‚æ— è®°äº‹å ä½ç¬¦ */
        .empty-placeholder {
            text-align: center;
            padding: 50px 0;
            color: var(--text-placeholder);
            font-size: 1.1em;
        }
        .empty-placeholder .icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        /* ç¼–è¾‘æ¨¡å¼ */
        .editing .memo-details .desc,
        .editing .memo-details .date {
            display: none;
        }
        .editing .memo-details {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .edit-input {
            width: 95%;
            padding: 5px;
            border-radius: 4px;
            border: 1px solid #334155;
            background-color: #0f172a;
            color: var(--text-light);
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1><span class="icon">ğŸ“–</span> ChronoNotes AI</h1>
            <span>å…± <span id="memo-count">0</span> æ¡è®°äº‹</span>
        </div>

        <!-- æ–°å»ºè®°äº‹å¡ç‰‡ -->
        <div class="new-memo-card">
            <h2>+ æ–°å»ºè®°äº‹</h2>
            <div class="input-group">
                <textarea id="memo-desc-input" class="text-input-area" placeholder="è®°å½•ä»Šå¤©çš„é‡è¦äº‹é¡¹..."></textarea>
            </div>
            
            <div class="input-group date-input-group">
                <span style="margin-right: 10px; color: var(--text-placeholder);">ğŸ“…</span>
                <input type="date" id="memo-date-input">
                <span style="color: var(--text-placeholder);">ğŸ—“ï¸</span>
            </div>

            <button onclick="addMemo()" class="add-button">æ·»åŠ è®°äº‹</button>
        </div>

        <!-- æ—¶é—´è½´ -->
        <div class="timeline-header">
            <span>æ—¶å…‰è½´</span>
            <button onclick="sortMemos('date')">æŒ‰æ—¶é—´é¡ºåº</button>
        </div>

        <ul id="memo-list" class="memo-list">
            <!-- è®°äº‹é¡¹é€šè¿‡ JavaScript æ’å…¥ -->
        </ul>

        <!-- æš‚æ— è®°äº‹å ä½ç¬¦ -->
        <div id="empty-state" class="empty-placeholder" style="display: none;">
            <div class="icon">ğŸ“…</div>
            æš‚æ— è®°äº‹<br>
            å¼€å§‹è®°å½•ä½ çš„ç¾å¥½ç”Ÿæ´»å§!
        </div>

    </div>

    <script>
        // --- JavaScript é€»è¾‘ ---
        const memoList = document.getElementById('memo-list');
        const memoDateInput = document.getElementById('memo-date-input');
        const memoDescInput = document.getElementById('memo-desc-input');
        const memoCountSpan = document.getElementById('memo-count');
        const emptyState = document.getElementById('empty-state');
        const STORAGE_KEY = 'chronoNotesList';

        // --- åˆå§‹åŒ–è®¾ç½® ---
        function init() {
            // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            memoDateInput.value = `${year}-${month}-${day}`;
            renderMemos();
        }

        // 1. åŠ è½½å’Œä¿å­˜æ•°æ®
        function loadMemos() {
            let memos;
            try {
                // å°è¯•ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
                memos = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            } catch (e) {
                console.error("Error loading data from Local Storage:", e);
                // å¦‚æœè§£æå¤±è´¥ï¼Œæ¸…ç©ºæœ¬åœ°å­˜å‚¨å¹¶è¿”å›ç©ºæ•°ç»„
                localStorage.removeItem(STORAGE_KEY);
                memos = [];
            }
            
            // ã€ä¿®å¤å…³é”®ç‚¹ã€‘è¿‡æ»¤æ‰ä»»ä½•æ ¼å¼ä¸æ­£ç¡®çš„å¯¹è±¡ï¼Œæé«˜å¥å£®æ€§
            memos = memos.filter(memo => memo && typeof memo.date === 'string' && typeof memo.description === 'string');

            // æŒ‰æ—¥æœŸå‡åºæ’åº (æ—¶é—´è¶Šæ—©è¶Šé å‰)
            memos.sort((a, b) => (a.date > b.date) ? 1 : -1);
            return memos;
        }

        function saveMemos(memos) {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(memos));
            } catch (e) {
                console.error("Error saving data to Local Storage:", e);
            }
        }

        // 2. æ¸²æŸ“äº‹é¡¹åˆ—è¡¨
        function renderMemos() {
            memoList.innerHTML = '';
            const memos = loadMemos();
            
            // æ£€æŸ¥æ˜¯å¦æœ‰è®°äº‹ï¼Œå¹¶æ˜¾ç¤º/éšè—å ä½ç¬¦
            if (memos.length === 0) {
                emptyState.style.display = 'block';
                memoCountSpan.textContent = '0';
                return;
            }
            
            emptyState.style.display = 'none';
            memoCountSpan.textContent = memos.length;

            memos.forEach((memo, index) => {
                const item = document.createElement('li');
                item.className = `memo-item`;
                item.setAttribute('data-index', index);

                item.innerHTML = `
                    <div class="memo-details">
                        <div class="date">${memo.date}</div>
                        <div class="desc">${memo.description}</div>
                        <!-- ç¼–è¾‘æ¨¡å¼ä¸‹çš„è¾“å…¥æ¡† (åˆå§‹éšè—) -->
                        <input type="date" class="edit-date-input edit-input" value="${memo.date}" style="display:none;">
                        <textarea class="edit-desc-input edit-input" style="display:none;">${memo.description}</textarea>
                    </div>
                    <div class="memo-actions">
                        <button class="edit-btn" onclick="editMemo(${index})" title="ç¼–è¾‘">âœï¸</button>
                        <button class="delete-btn" onclick="deleteMemo(${index})" title="åˆ é™¤">ğŸ—‘ï¸</button>
                    </div>
                `;
                memoList.appendChild(item);
            });
        }

        // 3. æ·»åŠ äº‹é¡¹
        function addMemo() {
            const date = memoDateInput.value.trim();
            const description = memoDescInput.value.trim();

            if (!date || !description) {
                alert('æ—¥æœŸå’Œäº‹é¡¹ç»†åˆ™éƒ½ä¸èƒ½ä¸ºç©ºï¼'); 
                return;
            }

            const memos = loadMemos();
            memos.push({ date, description });

            saveMemos(memos);
            renderMemos();

            // æ¸…ç©ºè¾“å…¥æ¡†
            memoDescInput.value = '';
        }
        
        // 4. åˆ é™¤äº‹é¡¹
        function deleteMemo(index) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™é¡¹äº‹é¡¹å—ï¼Ÿ')) return;
            
            const memos = loadMemos();
            memos.splice(index, 1); 

            saveMemos(memos);
            renderMemos();
        }

        // 5. ç¼–è¾‘äº‹é¡¹
        function editMemo(index) {
            const memos = loadMemos();
            const memo = memos[index];
            const listItem = memoList.querySelector(`.memo-item[data-index="${index}"]`);
            
            // åˆ‡æ¢ç¼–è¾‘æ¨¡å¼
            const isEditing = listItem.classList.toggle('editing');
            
            const editBtn = listItem.querySelector('.edit-btn');
            const dateInput = listItem.querySelector('.edit-date-input');
            const descInput = listItem.querySelector('.edit-desc-input');
            const dateDisplay = listItem.querySelector('.date');
            const descDisplay = listItem.querySelector('.desc');
            
            if (isEditing) {
                // è¿›å…¥ç¼–è¾‘æ¨¡å¼
                dateInput.style.display = 'block';
                descInput.style.display = 'block';
                dateDisplay.style.display = 'none';
                descDisplay.style.display = 'none';
                
                editBtn.innerHTML = 'ğŸ’¾'; // åˆ‡æ¢ä¸ºä¿å­˜å›¾æ ‡
                editBtn.title = 'ä¿å­˜ä¿®æ”¹';
            } else {
                // é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œæ‰§è¡Œä¿å­˜
                const newDate = dateInput.value.trim();
                const newDesc = descInput.value.trim();
                
                if (!newDate || !newDesc) {
                     alert('æ—¥æœŸå’Œäº‹é¡¹ç»†åˆ™éƒ½ä¸èƒ½ä¸ºç©ºï¼');
                     // é˜»æ­¢é€€å‡ºç¼–è¾‘ï¼Œè®©ç”¨æˆ·ç»§ç»­ç¼–è¾‘æˆ–å–æ¶ˆ
                     listItem.classList.add('editing');
                     return;
                }

                memos[index].date = newDate;
                memos[index].description = newDesc;
                
                saveMemos(memos);
                renderMemos(); // é‡æ–°æ¸²æŸ“åˆ—è¡¨ä»¥è¿›è¡Œæ’åºå’Œæ›´æ–°
            }
        }
        
        // 6. æ’åºåŠŸèƒ½ (é»˜è®¤å·²æŒ‰æ—¥æœŸæ’åºï¼Œæ­¤å‡½æ•°ä»…è§¦å‘é‡æ–°æ¸²æŸ“)
        function sortMemos(key) {
             const memos = loadMemos(); 
             saveMemos(memos); 
             renderMemos();
        }

        // åˆå§‹åŒ–ï¼šé¡µé¢åŠ è½½æ—¶æ¸²æŸ“åˆ—è¡¨
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>
